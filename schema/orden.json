{
  "$id": "http://example.com/example.json",
  "type": "object",
  "title": "Ordenes de Pedido",
  "limit": 300,
  "maxLimit": 500,
  "shareLevel": 5,
  "key": "orden",
  "namespace": "facturacion",
  "restricted": ["especial"],
  "pushToSocial": ["imprimir"],

  "properties": {
    "id": {
      "$id": "/properties/id",
      "type": "integer",
      "title": "Id",
      "locked": true,
      "sortable": true
    },
    "estado": {
      "$id": "/properties/estado",
      "type": "string",
      "title": "Estado",
      "filterable": true,
      "filterRenderer": "SelectFilter",
      "element": "select",
      "enum": [
        "por revisar",
        "por aplicar",
        "por aprobar",
        "por imprimir",
        "por enrutar",
        "por proformar",
        "por archivar",
        "por reactivar",
        "archivado"
      ]
    },
    "tipo": {
      "$id": "/properties/tipo",
      "type": "string",
      "title": "Tipo",
      "filterable": true,
      "filterRenderer": "SelectFilter",
      "element": "select",
      "default": "pedido",
      "enum": ["pedido", "proforma"]
    },
    "especial": {
      "$id": "/properties/especial",
      "type": "boolean",
      "title": "Especial",
      "filterable": true,
      "filterRenderer": "BooleanFilter",
      "formatter": "BooleanFormatter"
    },
    "name": {
      "$id": "/properties/name",
      "type": "string",
      "title": "Orden",
      "filterable": true,
      "sortabler": true,
      "helpText": "numero de orden del cliente"
    },
    "fuente": {
      "$id": "/properties/fuente",
      "type": "string",
      "title": "Fuente",
      "element": "select",
      "enum": ["ventas", "email", "whatsapp", "facebook", "web"],
      "default": "ventas",
      "filterRenderer": "SelectFilter",
      "filterable": true,
      "helpText": "en que canal recibimos el pedido"
    },
    "descripcion": {
      "$id": "/properties/descripcion",
      "type": "string",
      "title": "Descripcion",
      "formatter": "TextFormatter"
    },
    "plazo": {
      "$id": "/properties/plazo",
      "type": "integer",
      "title": "Plazo",
      "helpText": "plazo de credito del documento",
      "default": 0
    },
    "fechaAprobacion": {
      "$id": "/properties/fechaAprobacion",
      "type": "string",
      "title": "Fecha Aprobacion",
      "pattern": "[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}$"
    },
    "subTotal": {
      "$id": "/properties/subTotal",
      "type": "number",
      "title": "SubTotal",
      "readOnly": true
    },
    "subTotalConDescuento": {
      "$id": "/properties/subTotal",
      "type": "number",
      "title": "SubTotal",
      "readOnly": true
    },
    "impuesto": {
      "$id": "/properties/impuesto",
      "type": "number",
      "title": "Impuesto",
      "readOnly": true
    },
    "excento": {
      "$id": "/properties/excento",
      "type": "number",
      "title": "Total Excento",
      "readOnly": true
    },
    "cedula": {
      "$id": "/properties/cedula",
      "type": "string",
      "title": "Cedula",
      "helpText": "unicamente los numeros de la cedula"
    },
    "emails": {
      "$id": "/properties/emails",
      "type": "string",
      "title": "Email(s)",
      "helpText": "emails separado por una coma"
    },
    "descuento": {
      "$id": "/properties/descuento",
      "type": "number",
      "title": "Descuento",
      "readOnly": true
    },
    "resumen": {
      "$id": "/properties/resumen",
      "type": "string",
      "title": "Resumen",
      "width": 340
    },
    "total": {
      "$id": "/properties/total",
      "type": "number",
      "title": "Total",
      "readOnly": true
    },
    "approveBy": {
      "$id": "/properties/approveBy",
      "type": "string",
      "title": "Aprobado por"
    },
    "autoAplicar": {
      "$id": "/properties/autoAplicar",
      "type": "boolean",
      "title": "Auto Aplicar",
      "default": true
    },
    "negociado": {
      "$id": "/properties/negociado",
      "type": "boolean",
      "title": "Negociado",
      "default": false,
      "filterable": true,
      "sortable": true
    },

    "excentoTipo": {
      "$id": "/properties/excentoTipo",
      "type": "string",
      "title": "Tipo",
      "enum": ["01", "02", "03", "04", "05", "99"],
      "element": "select"
    },
    "excentoNumero": {
      "$id": "/properties/excentoNumero",
      "type": "string",
      "title": "Numero"
    },
    "excentoInstitucion": {
      "$id": "/properties/excentoInstitucion",
      "type": "string",
      "title": "Institucion"
    },
    "excentoFecha": {
      "$id": "/properties/excentoFecha",
      "type": "string",
      "title": "Fecha",
      "filterRenderer": "DateFilter",

      "element": "date"
    },
    "excentoPorcentaje": {
      "$id": "/properties/excentoPorcentaje",
      "type": "number",
      "title": "Porcentaje"
    },
    "promocionId": {
      "$id": "/properties/promocionId",
      "type": "integer",
      "title": "Promocion"
    },
    "clienteId": {
      "$id": "/properties/clienteId",
      "type": "integer",
      "title": "Cliente",
      "table": "cliente",
      "metadataType": "cliente",
      "filterable": true,

      "width": 200,
      "route": "cliente/findLikeName",
      "element": "autocomplete",
      "elementOptions": {
        "primary": "name"
      },
      "locked": true
    },
    "transporteId": {
      "$id": "/properties/transporteId",
      "type": "integer",
      "title": "Transporte",
      "table": "transporte",
      "filterable": true,
      "metadataType": "transporte",
      "route": "transporte/findLikeName",
      "element": "autocomplete",
      "helpText": "la forma en que se entrega la orden",
      "elementOptions": {
        "primary": "name"
      },
      "width": 220
    },
    "fecha": {
      "$id": "/properties/fecha",
      "type": "string",
      "element": "date",
      "title": "Fecha",
      "filterable": true,
      "sortable": true,
      "filterRenderer": "DateFilter"
    },
    "fechaEntrega": {
      "$id": "/properties/fechaEntrega",
      "type": "string",
      "element": "date",
      "title": "Fecha Entrega",
      "filterable": true,
      "sortable": true,
      "width": 200,
      "helpText": "la fecha pactada de entrega",
      "filterRenderer": "DateFilter"
    },
    "zonaId": {
      "$id": "/properties/zonaId",
      "type": "string",
      "title": "Zona",
      "sortable": true,
      "filterable": true,
      "select": "zona.name",
      "fields": [["name", "zonaId"]]
    },
    "ownerId": {
      "$id": "/properties/ownerId",
      "type": "integer",
      "title": "Propietario",
      "table": "owner",
      "filterable": true,
      "sortable": true,
      "route": "owner/findLikeName",
      "metadataType": "owner",
      "element": "autocomplete",
      "elementOptions": {
        "primary": "name"
      },
      "width": 250
    },
    "createdBy": {
      "$id": "/properties/createdBy",
      "type": "string",
      "title": "Creado por",
      "sortable": true,
      "filterable": true
    },
    "moneda": {
      "$id": "/properties/moneda",
      "type": "string",
      "title": "moneda",
      "enum": ["CRC", "USD"],
      "element": "select",
      "filterRenderer": "SelectFilter",
      "filterable": true,
      "default": "CRC"
    },
    "pdf": {
      "$id": "/properties/pdf",
      "type": "string",
      "title": "PDF",
      "formatter": "LinkFormatter"
    },

    "ordenTags": {
      "$id": "/properties/roles",
      "type": "string",
      "title": "Tags",
      "element": "multiselect",
      "filterable": true,
      "sortable": true,
      "table": "tag",
      "route": "tag/allWithName",
      "elementOptions": {
        "primary": "name"
      },
      "width": 200
    },
    "tipoCambio": {
      "$id": "/properties/tipoCambio",
      "type": "number",
      "title": "tipoCambio",
      "default": 1
    },
    "updatedBy": {
      "$id": "/properties/updatedBy",
      "type": "string",
      "title": "Actualizado por"
    },
    "createdAt": {
      "$id": "/properties/createdAt",
      "type": "string",
      "title": "Creado",
      "filterRenderer": "DateTimeFilter",
      "sortable": true,
      "filterable": true,
      "width": 150
    },
    "updatedAt": {
      "$id": "/properties/updatedAt",
      "type": "string",
      "title": "Actualizado",
      "sortable": true,
      "formatter": "DateTimeFormatter",
      "filterRenderer": "DateFilter",
      "filterable": true,
      "width": 150
    },
    "ordenLinea": {
      "isJSON": true,
      "width": 100,
      "title": "Productos",
      "formatter": "ChildFormatter",
      "fields": ["__productoId", "cantidad", "precio", "descuentoUnitario", "impuestoUnitario"],
      "editables": ["cantidad", "precio", "descuentoUnitario", "impuestoUnitario"],
      "idField": "productoId",
      "element": "table",
      "type": "string",
      "items": {
        "type": "object"
      }
    }
  },
  "belongsTo": ["cliente", "transporte", "owner", "cliente>zona"],
  "aprobarActions": ["por aprobar", "por reactivar"],
  "actions": [
    "Ver",
    "Crear",
    "Editar",
    "Aplicar",
    "Aprobar",
    {
      "title": "Imprimir",
      "then": "openUrl",
      "subscribe": "facturas",
      "icon": "Imprimir"
    },
    "Esperar",
    "Enrutar",
    {
      "title": "Proforma",
      "then": "openUrl"
    },
    "Borrar"
  ],
  "view": {
    "fields": [
      "id",
      "clienteId",
      "createdAt",
      "total",
      "ownerId",
      "estado",
      "zonaId",
      "transporteId",
      "especial",
      "tipo",
      "name",
      "plazo",
      "fechaEntrega",
      "fechaAprobacion",
      "createdBy",
      "updatedAt",
      "fuente"
    ],
    "fullFields": ["ordenLinea"]
  },
  "layout": [
    {
      "title": "Orden",
      "cols": 12,
      "fieldSize": 3,
      "fields": ["clienteId", "cedula", "emails", "name"]
    },
    {
      "title": "Opciones",
      "columns": 3,
      "fields": ["autoAplicar", "transporteId", "fechaEntrega", "plazo", "tipo", "fuente", "ownerId"]
    },

    {
      "title": "Productos",
      "columns": 9,
      "fieldSize": 12,
      "fields": ["ordenLinea"]
    },
    {
      "title": "Instrucciones",
      "cols": 12,
      "fieldSize": 12,
      "fields": ["descripcion", "ordenTags"]
    },
    {
      "title": "Totales",
      "cols": 12,
      "fieldSize": 3,
      "fields": ["moneda", "tipoCambio", "total", "subTotal", "descuento", "impuesto", "excento"]
    },

    {
      "title": "Excentos",
      "cols": 12,
      "fields": ["excentoTipo", "excentoNumero", "excentoInstitucion", "excentoFecha", "excentoPorcentaje"]
    }
  ],
  "batch": ["estado", "transporteId", "fechaEntrega"],
  "table": {
    "sum": ["total"],
    "fields": [
      "id",
      "clienteId",
      "createdAt",
      "total",
      "ownerId",
      "estado",
      "negociado",
      "zonaId",
      "transporteId",
      "especial",
      "tipo",
      "name",
      "plazo",
      "fechaEntrega",
      "fechaAprobacion",
      "createdBy",
      "updatedAt",
      "fuente",
      "ordenTags"
    ]
  }
}
